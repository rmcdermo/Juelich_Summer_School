# LES Equations

## Idea: Subgrid Scale (SGS) Modelling

figure with energy specturm illustrating the resolved and modelled parts

resolved vs. modeled sub-grid scale quantites, e.g. k_sgs and K for kinetic energy

![](./figs/Scales-DNS-LES.png)

## Temporal Averaging

definition, illustrative figure with u(t) = u_mean + u_fluct

## Spatial Filtering

using a filter width $\Delta$, define a "box" filtered quantity $\overline{\phi}$

$$ 
\overline{\phi}(x, y, z, t) \equiv \frac{1}{V_c}
\int_{x - \delta x / 2}^{x + \delta x / 2}
\int_{y - \delta y / 2}^{y + \delta y / 2}
\int_{z - \delta z / 2}^{z + \delta z / 2}
\phi(x', y', z', t) \, \mathrm{d}x' \, \mathrm{d}y' \, \mathrm{d}z'
$$

mean of the square vs. square of the mean

Favre averaging for variable density

$$
\overline{\rho} \, \widetilde{\phi} \equiv \overline{\rho \phi} \quad \Rightarrow \quad \widetilde{\phi} \equiv \frac{\overline{\rho \phi}}{\overline{\rho}}
$$

needed, when density is not constant, as otherwise conservation properties may not be conserved

## Exercise -- Filter a Given Function

is this a good / needed exercise?

exercise with simple numbers, done on paper

given (e.g. three value pairs) u and rho, compute u_bar and u_tilde and u_rho_bar

check for for total momentum with / without favre filter

| Cell | $\rho$ (kg/m^3) | $u$ (m/s) | $\rho u$ (kg/m^2/s) |
| ---- | --------------- | --------- | ------------------- |
| 1    | 1.0             | 10.0      | 10.0                |
| 2    | 10.0            | 1.0       | 10.0                |
| 3    | 1.0             | 10.0      | 10.0                |


## LES Momentum Equation (I)

DNS equation (without mass source, external forces)

$$ 
\frac{\partial \rho u_i}{\partial t} + \frac{\partial}{\partial x_j} (\rho u_i u_j) 
= -\frac{\partial p}{\partial x_i} - \frac{\partial \tau_{ij}}{\partial x_j} 
+ \rho g_i + f_{d,i} + \dot{m}'''_{\text{b}} u_{\text{b},i}
$$


use spatial filter, derivatives and filtering commute

$$
\frac{\partial \overline{\rho u_i}}{\partial t}
+ \frac{\partial}{\partial x_j} (\overline{\rho u_i u_j})
= -\frac{\partial \overline{p}}{\partial x_i}
- \frac{\partial \overline{\tau_{ij}}}{\partial x_j}
+ \overline{\rho} g_i + \overline{f_{d,i}} + \overline{\dot{m}'''_{\text{b}} u_{\text{b},i}}
$$

Problem: $\overline{\rho u_i u_j}$

Use Favre filter: $\overline{\rho} \, \widetilde{{u}_i {u}_j}$

## LES Momentum Equation (II)

$$
\frac{\partial \overline{\rho} \, \tilde{u}_i}{\partial t}
+ \frac{\partial}{\partial x_j} \left( \overline{\rho} \, \widetilde{{u}_i {u}_j} \right)
= -\frac{\partial \overline{p}}{\partial x_i}
- \frac{\partial \overline{\tau}_{ij}}{\partial x_j}
+ \overline{\rho} \, g_i
+ \overline{f}_{d,i}
+ \overline{\dot{m}'''_b} \, \tilde{u}_{b,i}
$$


all primitve variables, but $\widetilde{{u}_i {u}_j} \neq\tilde{u}_i\tilde{u}_j$

find closure, but defining a sub-grid scale stress $\tau_{ij}^{\text{sgs}}$

$$
\tau_{ij}^{\text{sgs}} \equiv \overline{\rho} \left( \widetilde{u_i u_j} - \tilde{u}_i \tilde{u}_j \right)
$$

this leads to the LES momentum equation

$$
\frac{\partial \overline{\rho} \, \tilde{u}_i}{\partial t}
+ \frac{\partial}{\partial x_j} \left( \overline{\rho} \, \tilde{u}_i \tilde{u}_j \right)
= -\frac{\partial \overline{p}}{\partial x_i}
- \frac{\partial \overline{\tau}_{ij}}{\partial x_j}
- \frac{\partial \tau^{\mathrm{sgs}}_{ij}}{\partial x_j}
+ \overline{\rho} \, g_i
+ \overline{f}_{\mathrm{d},i}
+ \overline{\dot{m}'''_{\mathrm{b}}} \, \tilde{u}_{\mathrm{b},i}
$$

## Turbulent Viscosity

decompose $\tau_{ij}^{\text{sgs}}$

$$
\tau_{ij}^{\mathrm{dev}} \equiv \overline{\tau}_{ij} + \tau^{\mathrm{sgs}}_{ij} 
- \frac{1}{3} \tau^{\mathrm{sgs}}_{kk} \delta_{ij}
= -2 (\mu + \mu_t) \left( \widetilde{S}_{ij} - \frac{1}{3} (\nabla \cdot \widetilde{\mathbf{u}}) \delta_{ij} \right)
$$

turbulent viscosity $\mu_t$ must be modelled

sub-grid scale kinetic energy $k_{sgs}$

$$
k_{\mathrm{sgs}} \equiv \frac{1}{2} \tau_{kk}^{\mathrm{sgs}}
$$

pressure

$$
\bar{p} \equiv \overline{p} + \frac{2}{3} k_{\mathrm{sgs}}
$$

leads to apparently same equations as DNS

$$
\frac{\partial \overline{\rho} \, \widetilde{u}_i}{\partial t}
+ \frac{\partial}{\partial x_j} \left( \overline{\rho} \, \widetilde{u}_i \widetilde{u}_j \right)
= -\frac{\partial \bar{p}}{\partial x_i}
- \frac{\partial \tau^{\mathrm{dev}}_{ij}}{\partial x_j}
+ \overline{\rho} \, g_i
+ \overline{f}_{\mathrm{d},i}
+ \overline{\dot{m}'''_{\mathrm{b}}} \, \widetilde{u}_{\mathrm{b},i}
$$

## Transport of Kinetic Energy

resolved kinetic energy: $K \equiv \frac{1}{2} \widetilde{u}_i \widetilde{u}_i$

$$
\overline{\rho} \,\frac{D K}{D t}
= -\widetilde{u}_i \frac{\partial \bar{p}}{\partial x_i}
- \widetilde{u}_i \frac{\partial \tau^{\mathrm{dev}}_{ij}}{\partial x_j}
+ (\overline{\rho} \, g_i + \overline{f}_{\mathrm{b},i}) \widetilde{u}_i
$$

and

$$
\overline{\rho} \, \frac{D K}{D t}
+ \frac{\partial}{\partial x_j} \left( \left[ \bar{p} \, \delta_{ij} + \tau^{\mathrm{dev}}_{ij} \right] \widetilde{u}_i \right)
= \bar{p} \, \frac{\partial \widetilde{u}_i}{\partial x_i}
+ \tau^{\mathrm{dev}}_{ij} \, \frac{\partial \widetilde{u}_i}{\partial x_j}
+ (\overline{\rho} \, g_i + \overline{f}_{\mathrm{b},i}) \widetilde{u}_i
$$

## Thermal Coduction and Species Diffusion 

$$
k_t = \frac{\mu_t c_p}{\mathrm{Pr}_t}
$$

and

$$
(\rho D)_t = \frac{\mu_t}{\mathrm{Sc}_t}
$$

with the assumption / choice of Pr_t = Sc_t = const. = 0.5