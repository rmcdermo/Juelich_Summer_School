---
title: "Turbulence in Fire -- Phenomena, Equations and Models"
subtite: "A custom presentation for you to adapt as you see fit"
format: 
  revealjs:
    # theme: serif
    # theme: simple
    # theme: solarized
    slide-number: "c"
    css: custom.css
    margin: 0.05
    html-math-method: 
      method: mathjax
      # url: https://cdn.jsdelivr.net/npm/mathjax@4.0.0-alpha.1/es5/tex-mml-chtml.js
      url: https://cdn.jsdelivr.net/npm/mathjax@4.0.0-beta.3/tex-mml-chtml.min.js
editor: visual
author:
  - name: "Lukas Arnold"
    id: la
    orcid: 0000-0000-0000-0001
    email: l.arnold@fz-juelich.de
    affiliation: 
      - name: Forschungszentrum Jülich & <br>University of Wuppertal
  - name: "Bjarne Husted"
    id: bh
    orcid: 0000-0000-0000-0002
    email: bphu@dtu.dk
    affiliation:
      - name: Danmarks Tekniske Universitet
  - name: "Randall McDermott"
    id: rm
    orcid: 0000-0003-3815-3400
    email: randall.mcdermott@nist.gov
    affiliation: 
      - name: National Institute of <br> Standards and Technology
# logo: /content/rdsvs.png
footer: "Turbulence -- Summer School Padua"
# bibliography: references.bib
---

# Introduction and Overview

## Teaching goals

xxx



# Phenomena

## Example -- From a laminar to a turbulent flow

Example of a candle plume, which transits from a laminar to a turbulent flow.

## Macroscopic impact

In general: 

- Intermittency
- Scalar Mixing
- Eddies
- Cascade
- Dissipation at small scales
- Chaotic, yet structured

In fire dynamics:

- mixing for combustion
- fire plume dynamics
- enhance of heat and mass transfer

## Example?

pipe flow

magnitude velocity profile

non trivial normal velocities

instantanious velocity values (maybe from our plume measurements?)

## Exercise -- Compute fluctuation spectrum?

given instantanious velocity data, compute fluctuations

![](./figs/Fluctuations-Results.png)

# Fundamentals Turbulence

## Governing Equations -- needed at this point?

Navier Stokes equation

species equation

energy equation

## Reynolds Experiment (1883)

![](./figs/Flows_from_Reynolds_1883_paper.jpg)

## Reynolds Number

The Reynolds number (Re) is the ratio of inertial to viscous forces in a fluid (element). 

$$ \text{Re} = \frac{vL}{\nu} = \frac{\rho v L}{\mu} $$

With: 

- the fluid density $\rho$, in $kg/m^3$
- the flow velocity $v$, in $m/s$
- a characteristic length scale $L$, in $m$
- the dynamic $\mu$ and kinematic $\nu$ viscosity of the fluid, in $kg/(ms)$ and $m^2/s$

## Turbulence Characterisation with the Reynolds Number

Example pipe flow?

- Re < xxx : laminar
- Re > xxx : turbulent

Example, estimate Re for a candle and a pool fire 

## Exercise 02 -- Kármán Vortex Street

**Description:** One of the impact parameters on the flow structure behind an object is the Reynolds number (Re). A classical phenomenon is the Kármán vortex street. In this example, the impact of Re is qualitatively investigated. 

The simulation geometry is a 2D domain with a main object (plate) and a small object to destroy the symmetry. There is an fixed inflow boundary condition at $x_{\text{min}}$ and an open boundary condition at $x_{\text{max}}$. Both boundaries in z-direction are solid walls.

![](./exercises/vortex_street/Geometry_Sketch.png)

## Exercise 02 -- Tasks

1. Run the execution of the provided FDS input file (vortex_street.fds). 
2. Visuailize the result.

FDS example, dancing eddies

run provided example case

estimate Re, change Re

## Exercise -- Results

![low Re, nu=1.2e-4](./figs/VortexStreet-sim-lowRe.png){height=125}

![mid Re, nu=1.2e-5](./figs/VortexStreet-sim-midRe.png){height=125}

![high Re, nu=1.2e-6](./figs/VortexStreet-sim-highRe.png){height=125}


## Scales in Turbulence

![](./figs/Scales-Overview.png)

Integral scale 

Intertial scale

Kolmogorov scale

## Kolmogorov theory

Assumptions:

- Universal, i.e. independet of how turbulence was generated
- (Local) isotropy
- Energy cascade, kinetic energy is transported from large to small scales without losses, until it is dissipated at the smallest scales by viscosity

Kolmogorov Scales:

- length: $\eta = \left( \frac{\nu^3}{\varepsilon} \right)^{1/4}$
- time: $\tau_\eta = \left( \frac{\nu}{\varepsilon} \right)^{1/2}$
- velocity: $u_\eta = (\nu \varepsilon)^{1/4}$

## Energy Spectrum

$$E(k) = C \, \varepsilon^{2/3} \, k^{-5/3}$$

![](./figs/Energy-Spectrum.png)

## Numerical Resolution

![](./figs/Numerical-Resolution.png)

## DNS

direct solution of the NSE
no turbulence model

$$ 
\frac{\partial \rho u_i}{\partial t} + \frac{\partial}{\partial x_j} (\rho u_i u_j) 
= -\frac{\partial p}{\partial x_i} - \frac{\partial \tau_{ij}}{\partial x_j} 
+ \rho g_i + f_{d,i} + \dot{m}'''_{\text{b}} u_{\text{b},i}
$$

$\eta$ needs to be resolved

$$
\eta = \left( \frac{\nu^3}{\varepsilon} \right)^{1/4}
$$

dissipation rate

$$
\varepsilon \equiv \tau_{ij} \frac{\partial u_i}{\partial x_j}
= 2\mu \left( S_{ij} S_{ij} - \frac{1}{3} (\nabla \cdot \mathbf{u})^2 \right)
$$

and strain rate tensor

$$
S_{ij} \equiv \frac{1}{2} \left( \frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right)
$$

## Exercise -- Estimate $\eta$

Use estimation of dissipation rate eps = U^3 / L

U, L at large scale

eta approx L * Re^-3/4

do the small scales matter?

High numerical resolution needed down to $\eta$

# LES Equations

## Idea: Subgrid Scale (SGS) Modelling

figure with energy specturm illustrating the resolved and modelled parts

resolved vs. modeled sub-grid scale quantites, e.g. k_sgs and K for kinetic energy

![](./figs/Scales-DNS-LES.png)

## Temporal Averaging

definition, illustrative figure with u(t) = u_mean + u_fluct

## Spatial Filtering

using a filter widht $\Delta$, define filtered quantity $\overline{\phi}$

$$ 
\overline{\phi}(x, y, z, t) \equiv \frac{1}{V_c}
\int_{x - \delta x / 2}^{x + \delta x / 2}
\int_{y - \delta y / 2}^{y + \delta y / 2}
\int_{z - \delta z / 2}^{z + \delta z / 2}
\phi(x', y', z', t) \, \mathrm{d}x' \, \mathrm{d}y' \, \mathrm{d}z'
$$

mean of the square vs. sqare of the mean

Favre averaging for variable density

$$
\overline{\rho} \, \widetilde{\phi} \equiv \overline{\rho \phi} \quad \Rightarrow \quad \widetilde{\phi} \equiv \frac{\overline{\rho \phi}}{\overline{\rho}}
$$

needed, when density is not constant, as otherwise conservation properties may not be conserved

## Exercise -- Filter a Given Function

is this a good / needed exercise?

exercise with simple numbers, done on paper

given (e.g. three value pairs) u and rho, compute u_bar and u_tilde and u_rho_bar

check for for total momentum with / without favre filter

| Cell | $\rho$ (kg/m^3) | $u$ (m/s) | $\rho u$ (kg/m^2/s) |
| ---- | --------------- | --------- | ------------------- |
| 1    | 1.0             | 10.0      | 10.0                |
| 2    | 10.0            | 1.0       | 10.0                |
| 3    | 1.0             | 10.0      | 10.0                |


## LES Momentum Equation (I)

DNS equation (without mass source, external forces)

$$ 
\frac{\partial \rho u_i}{\partial t} + \frac{\partial}{\partial x_j} (\rho u_i u_j) 
= -\frac{\partial p}{\partial x_i} - \frac{\partial \tau_{ij}}{\partial x_j} 
+ \rho g_i + f_{d,i} + \dot{m}'''_{\text{b}} u_{\text{b},i}
$$


use spatial filter, derivatives and filtering commute

$$
\frac{\partial \overline{\rho u_i}}{\partial t}
+ \frac{\partial}{\partial x_j} (\overline{\rho u_i u_j})
= -\frac{\partial \overline{p}}{\partial x_i}
- \frac{\partial \overline{\tau_{ij}}}{\partial x_j}
+ \overline{\rho} g_i + \overline{f_{d,i}} + \overline{\dot{m}'''_{\text{b}} u_{\text{b},i}}
$$

Problem: $\overline{\rho u_i u_j}$

Use Favre filter: $\overline{\rho} \, \widetilde{{u}_i {u}_j}$

## LES Momentum Equation (II)

$$
\frac{\partial \overline{\rho} \, \widetilde{u}_i}{\partial t}
+ \frac{\partial}{\partial x_j} \left( \overline{\rho} \, \widetilde{{u}_i {u}_j} \right)
= -\frac{\partial \overline{p}}{\partial x_i}
- \frac{\partial \overline{\tau}_{ij}}{\partial x_j}
+ \overline{\rho} \, g_i
+ \overline{f}_{d,i}
+ \overline{\dot{m}'''_b} \, \widetilde{u}_{b,i}
$$


all primitve variables, but $\widetilde{{u}_i {u}_j} \neq\widetilde{{u}_i}\widetilde{{u}_j}$

find closure, but defining a sub-grid scale stress $\tau_{ij}^{\text{sgs}}$

$$
\tau_{ij}^{\text{sgs}} \equiv \overline{\rho} \left( \widetilde{u_i u_j} - \widetilde{u}_i \widetilde{u}_j \right)
$$

this leads to the LES momentum equation

$$
\frac{\partial \overline{\rho} \, \widetilde{u}_i}{\partial t}
+ \frac{\partial}{\partial x_j} \left( \overline{\rho} \, \widetilde{u}_i \widetilde{u}_j \right)
= -\frac{\partial \overline{p}}{\partial x_i}
- \frac{\partial \overline{\tau}_{ij}}{\partial x_j}
- \frac{\partial \tau^{\mathrm{sgs}}_{ij}}{\partial x_j}
+ \overline{\rho} \, g_i
+ \overline{f}_{\mathrm{d},i}
+ \overline{\dot{m}'''_{\mathrm{b}}} \, \widetilde{u}_{\mathrm{b},i}
$$

## Turbulent Viscosity

decompose $\tau_{ij}^{\text{sgs}}$

$$
\tau_{ij}^{\mathrm{dev}} \equiv \overline{\tau}_{ij} + \tau^{\mathrm{sgs}}_{ij} 
- \frac{1}{3} \tau^{\mathrm{sgs}}_{kk} \delta_{ij}
= -2 (\mu + \mu_t) \left( \widetilde{S}_{ij} - \frac{1}{3} (\nabla \cdot \widetilde{\mathbf{u}}) \delta_{ij} \right)
$$

turbulent viscosity $\mu_t$ must be modelled

sub-grid scale kinetic energy $k_{sgs}$

$$
k_{\mathrm{sgs}} \equiv \frac{1}{2} \tau_{kk}^{\mathrm{sgs}}
$$

pressure

$$
\bar{p} \equiv \overline{p} + \frac{2}{3} k_{\mathrm{sgs}}
$$

leads to apparently same equations as DNS

$$
\frac{\partial \overline{\rho} \, \widetilde{u}_i}{\partial t}
+ \frac{\partial}{\partial x_j} \left( \overline{\rho} \, \widetilde{u}_i \widetilde{u}_j \right)
= -\frac{\partial \bar{p}}{\partial x_i}
- \frac{\partial \tau^{\mathrm{dev}}_{ij}}{\partial x_j}
+ \overline{\rho} \, g_i
+ \overline{f}_{\mathrm{d},i}
+ \overline{\dot{m}'''_{\mathrm{b}}} \, \widetilde{u}_{\mathrm{b},i}
$$

## Transport of Kinetic Energy

resolved kinetic energy: $K \equiv \frac{1}{2} \widetilde{u}_i \widetilde{u}_i$

$$
\overline{\rho} \,\frac{D K}{D t}
= -\widetilde{u}_i \frac{\partial \bar{p}}{\partial x_i}
- \widetilde{u}_i \frac{\partial \tau^{\mathrm{dev}}_{ij}}{\partial x_j}
+ (\overline{\rho} \, g_i + \overline{f}_{\mathrm{b},i}) \widetilde{u}_i
$$

and

$$
\overline{\rho} \, \frac{D K}{D t}
+ \frac{\partial}{\partial x_j} \left( \left[ \bar{p} \, \delta_{ij} + \tau^{\mathrm{dev}}_{ij} \right] \widetilde{u}_i \right)
= \bar{p} \, \frac{\partial \widetilde{u}_i}{\partial x_i}
+ \tau^{\mathrm{dev}}_{ij} \, \frac{\partial \widetilde{u}_i}{\partial x_j}
+ (\overline{\rho} \, g_i + \overline{f}_{\mathrm{b},i}) \widetilde{u}_i
$$

## Thermal Coduction and Species Diffusion 

$$
k_t = \frac{\mu_t c_p}{\mathrm{Pr}_t}
$$

and

$$
(\rho D)_t = \frac{\mu_t}{\mathrm{Sc}_t}
$$

with the assumption / choice of Pr_t = Sc_t = const. = 0.5

# LES Turbulent Viscosity Models 

## General Idea

## Smagorinski

## Deardorff

## Exercise -- Decay of Resolved Kinetic Energy 

Use FDS case as basis

add analysis to estimate the evolution of kinetic energy as a function of time


![](./figs/EnergyDecay-sim-IC.png){height=150}

## Exercise -- Results

![](./figs/EnergyDecay-sim-Result.png)

## Exercise -- Shear Flow

setup: shear flow, 2D, bounded, periodic

creation of vortices and kinetic energy

goal: ??

## Exercise -- Results

![](./figs/ShearFlow-sim-Result.png)

## Thermal and material diffusivity



## Simulation modes in FDS

| **Key Parameter**              | **'DNS'**    | **'LES'**    | **'VLES'**      | **'SVLES'**     |
|--------------------------------|--------------|--------------|-----------------|-----------------|
| `CFL_VELOCITY_NORM`            | 1            | 1            | 2               | 3               |
| `CHECK_VN`                     | T            | T            | T               | F               |
| `FLUX_LIMITER`                 | 'CHARM'      | 'CHARM'      | 'SUPERBEE'      | 'SUPERBEE'      |
| `CONSTANT_SPECIFIC_HEAT_RATIO` | F            | F            | F               | T               |
| `EXTINCTION_MODEL`             | 2            | 2            | 1               | 1               |


## FDS user perspective on turbulence

## Not Covered

- Boundary layers
- Wall functions
- Interaction of Turbulence with chemistry and radiation

## Summary

## Exercise -- Mixing??

## Exercise -- Lukas naive plume